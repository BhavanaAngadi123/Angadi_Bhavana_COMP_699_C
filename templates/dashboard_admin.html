{% extends "base.html" %}
{% block content %}
<style>
body {
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(145deg, #e0f7fa, #e1bee7);
    min-height: 100vh;
    padding: 20px 0;
}

/* ---------- SUMMARY CARDS ---------- */
.summary-cards {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    margin-bottom: 40px;
}
.summary-card {
    flex: 1 1 calc(25% - 20px);
    background: linear-gradient(135deg, #fff, #f0f0f0);
    border-radius: 20px;
    padding: 30px 20px;
    text-align: center;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    transition: transform 0.3s, box-shadow 0.3s;
}
.summary-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 15px 40px rgba(0,0,0,0.2);
}
.summary-card h5 { font-weight: 600; margin-bottom: 15px; }
.summary-card h2 { font-size: 2rem; color: #fff; }

/* ---------- CARDS FOR PETS & PRODUCTS ---------- */
.card-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
}
.card-item {
    flex: 1 1 calc(25% - 20px);
    background: #fff;
    border-radius: 20px;
    overflow: hidden;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    transition: transform 0.3s;
}
.card-item:hover {
    transform: translateY(-10px);
}
.card-item img {
    width: 100%;
    height: 180px;
    object-fit: cover;
}
.card-item .card-body {
    padding: 15px;
}
.card-item .card-body h5 {
    font-size: 1.1rem;
    font-weight: 600;
    margin-bottom: 5px;
}
.card-item .card-body p {
    font-size: 0.9rem;
    margin-bottom: 5px;
    color: #555;
}

/* ---------- LIST CARDS USERS & SITTERS ---------- */
.list-cards {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    margin-top: 40px;
}
.list-card {
    flex: 1 1 calc(50% - 20px);
    background: linear-gradient(135deg, #fff, #f5f5f5);
    border-radius: 20px;
    padding: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
}
.list-card h4 {
    text-align: center;
    margin-bottom: 20px;
    font-weight: 600;
}
.list-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 0;
    border-bottom: 1px solid #eee;
}
.list-item:last-child { border-bottom: none; }
.list-item a {
    text-decoration: none;
    font-weight: 600;
    color: #4e73df;
}
.list-item .badge {
    padding: 5px 10px;
    border-radius: 12px;
    background: #4e73df;
    color: #fff;
    font-size: 0.8rem;
}

/* ---------- RESPONSIVE ---------- */
@media (max-width: 992px) {
    .summary-card { flex: 1 1 calc(50% - 20px); }
    .card-item { flex: 1 1 calc(50% - 20px); }
    .list-card { flex: 1 1 100%; }
}
@media (max-width: 576px) {
    .summary-card { flex: 1 1 100%; }
    .card-item { flex: 1 1 100%; }
}
</style>

<div class="container">
    <h2 class="mb-4 text-center" style="color:#333;">Admin Dashboard</h2>

    <!-- SUMMARY CARDS -->
    <div class="summary-cards">
        <div class="summary-card" style="background: linear-gradient(135deg, #4e73df, #1cc88a);">
            <h5>Users</h5>
            <h2>{{ users|selectattr('role','equalto','owner')|list|length }}</h2>
        </div>
        <div class="summary-card" style="background: linear-gradient(135deg, #1cc88a, #36b9cc);">
            <h5>Sitters</h5>
            <h2>{{ sitters|length }}</h2>
        </div>
        <div class="summary-card" style="background: linear-gradient(135deg, #f6c23e, #f4b619);">
            <h5>Pets</h5>
            <h2>{{ pets|length }}</h2>
        </div>
        <div class="summary-card" style="background: linear-gradient(135deg, #e74a3b, #ff6f61);">
            <h5>Products</h5>
            <h2>{{ products|length }}</h2>
        </div>
    </div>

    <!-- PET CARDS -->
    <h4 class="mb-3">Pets</h4>
    <div class="card-grid">
        {% for pet in pets %}
        <div class="card-item">
            {% if pet.image %}
            <img src="{{ url_for('static', filename='uploads/' ~ pet.image) }}" alt="{{ pet.name }}">
            {% else %}
            <img src="{{ url_for('static', filename='uploads/default-avatar.png') }}" alt="{{ pet.name }}">
            {% endif %}
            <div class="card-body">
                <h5>{{ pet.name }}</h5>
                <p>{{ pet.species }} - {{ pet.breed or 'N/A' }}</p>
                <p>Owner: {{ pet.owner.name if pet.owner else 'N/A' }}</p>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- PRODUCT CARDS -->
    <h4 class="mb-3 mt-5">Products</h4>
    <div class="card-grid">
        {% for product in products %}
        <div class="card-item">
            {% if product.image %}
            <img src="{{ url_for('static', filename='uploads/' ~ product.image) }}" alt="{{ product.name }}">
            {% else %}
            <img src="{{ url_for('static', filename='uploads/default-product.png') }}" alt="{{ product.name }}">
            {% endif %}
            <div class="card-body">
                <h5>{{ product.name }}</h5>
                <p>Price: ${{ product.price }}</p>
                <p>Seller: {{ product.seller.name if product.seller else 'N/A' }}</p>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- USERS & SITTERS LIST -->
    <div class="list-cards">
        <!-- USERS -->
        <div class="list-card">
            <h4>Users</h4>
            {% for user in users if user.role=='owner' %}
            <div class="list-item">
                <div>{{ user.name }} <br> {{ user.email }}</div>
                <a href="{{ url_for('admin.delete_user', user_id=user.id) }}" class="btn btn-danger btn-sm">Delete</a>
            </div>
            {% endfor %}
        </div>

        <!-- SITTERS -->
        <div class="list-card">
            <h4>Sitters</h4>
            {% for sitter in sitters %}
            <div class="list-item">
                <div>
                    <a href="{{ url_for('admin.sitter_profile', sitter_id=sitter.id) }}">{{ sitter.name }}</a><br>
                    {{ sitter.email }}
                </div>
                <span class="badge">{{ sitter.verification_status.capitalize() }}</span>
                {% if sitter.verification_status == 'pending' %}
                    <a href="{{ url_for('admin.verify_sitter', sitter_id=sitter.id, action='approved') }}" class="btn btn-success btn-sm">Approve</a>
                    <a href="{{ url_for('admin.verify_sitter', sitter_id=sitter.id, action='rejected') }}" class="btn btn-warning btn-sm">Reject</a>
                {% endif %}
                <a href="{{ url_for('admin.delete_sitter', sitter_id=sitter.id) }}" class="btn btn-danger btn-sm">Delete</a>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}
